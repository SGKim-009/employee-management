# Phase 1 테스트 가이드

이 문서는 Phase 1의 보안 강화, 인증 시스템, 역할 기반 접근 제어에 대한 테스트 가이드를 제공합니다.

## 📋 목차

1. [보안 테스트](#보안-테스트)
2. [인증 시스템 테스트](#인증-시스템-테스트)
3. [역할 기반 접근 제어 테스트](#역할-기반-접근-제어-테스트)
4. [유효성 검증 테스트](#유효성-검증-테스트)

---

## 보안 테스트

### 테스트 항목: 비인증 사용자가 데이터 접근 불가 확인

#### 1. 비인증 상태에서 페이지 접근 테스트

**절차:**
1. 브라우저에서 로그아웃 상태 확인
2. 메인 페이지(`/`) 접속 시도
3. 다른 보호된 페이지 접속 시도:
   - `/dashboard`
   - `/resigned`
   - `/notifications`

**예상 결과:**
- ✅ 자동으로 로그인 페이지(`/login`)로 리다이렉트됨
- ✅ 데이터에 접근할 수 없음
- ✅ API 호출이 실패하거나 인증 오류 반환

#### 2. RLS 정책 테스트

**절차:**
1. Supabase 대시보드에서 RLS 정책 확인
2. 비인증 사용자로 직접 데이터베이스 쿼리 시도 (Supabase SQL Editor 사용)

**예상 결과:**
- ✅ `employees` 테이블에 대한 SELECT 쿼리가 실패
- ✅ INSERT, UPDATE, DELETE 쿼리가 모두 실패
- ✅ RLS 정책이 활성화되어 있음

#### 3. Storage 접근 테스트

**절차:**
1. 비인증 상태에서 프로필 이미지 URL 직접 접근 시도
2. 파일 다운로드 URL 접근 시도

**예상 결과:**
- ✅ Storage 버킷의 RLS 정책으로 인해 접근 거부
- ✅ 인증 오류 메시지 표시

---

## 인증 시스템 테스트

### 테스트 항목: 로그인/로그아웃 플로우 확인

#### 1. 로그인 테스트

**절차:**
1. 로그인 페이지(`/login`) 접속
2. 유효한 이메일과 비밀번호 입력
3. 로그인 버튼 클릭

**예상 결과:**
- ✅ 로그인이 성공함
- ✅ 메인 페이지로 리다이렉트됨
- ✅ 인증 상태가 유지됨
- ✅ 세션이 저장됨 (localStorage 또는 쿠키)

#### 2. 잘못된 자격증명 테스트

**절차:**
1. 로그인 페이지에서 잘못된 이메일 또는 비밀번호 입력
2. 로그인 버튼 클릭

**예상 결과:**
- ✅ 로그인이 실패함
- ✅ 적절한 오류 메시지 표시
- ✅ 로그인 페이지에 머물러 있음

#### 3. 로그아웃 테스트

**절차:**
1. 로그인 상태에서 네비게이션의 로그아웃 버튼 클릭
2. 로그아웃 후 페이지 상태 확인

**예상 결과:**
- ✅ 로그아웃이 성공함
- ✅ 로그인 페이지로 리다이렉트됨
- ✅ 세션이 제거됨
- ✅ 보호된 페이지 접근 시 다시 로그인 요구

#### 4. 세션 유지 테스트

**절차:**
1. 로그인 후 브라우저 새로고침
2. 다른 탭에서도 로그인 상태 확인

**예상 결과:**
- ✅ 새로고침 후에도 로그인 상태 유지
- ✅ 다른 탭에서도 동일한 세션 공유
- ✅ 세션이 만료되기 전까지 유지됨

#### 5. 세션 만료 테스트

**절차:**
1. 로그인 후 장시간 대기 (세션 만료 시간 확인)
2. 페이지 새로고침 또는 API 호출

**예상 결과:**
- ✅ 세션 만료 시 자동으로 로그인 페이지로 리다이렉트
- ✅ 적절한 만료 메시지 표시 (선택사항)

---

## 역할 기반 접근 제어 테스트

### 테스트 항목: 각 역할로 로그인하여 권한 확인

#### 1. Admin 역할 테스트

**절차:**
1. Admin 역할로 로그인
2. 각 기능 접근 시도:
   - 직원 추가
   - 직원 수정
   - 직원 삭제
   - 직원 조회
   - 대시보드 접근
   - 파일 관리

**예상 결과:**
- ✅ 모든 기능에 접근 가능
- ✅ 모든 버튼이 표시됨
- ✅ 삭제 버튼이 활성화됨
- ✅ 모든 데이터 조회 가능

#### 2. HR 역할 테스트

**절차:**
1. HR 역할로 로그인
2. 각 기능 접근 시도:
   - 직원 추가
   - 직원 수정
   - 직원 삭제
   - 직원 조회
   - 대시보드 접근

**예상 결과:**
- ✅ 읽기/쓰기 권한 있음
- ✅ 직원 추가/수정 가능
- ✅ 직원 삭제 불가 (버튼 숨김 또는 비활성화)
- ✅ 모든 데이터 조회 가능

#### 3. Viewer 역할 테스트

**절차:**
1. Viewer 역할로 로그인
2. 각 기능 접근 시도:
   - 직원 추가
   - 직원 수정
   - 직원 삭제
   - 직원 조회
   - 대시보드 접근

**예상 결과:**
- ✅ 읽기 전용 권한
- ✅ 직원 추가/수정/삭제 불가 (버튼 숨김 또는 비활성화)
- ✅ 모든 데이터 조회 가능
- ✅ 대시보드 접근 가능

#### 4. 권한별 UI 확인

**절차:**
1. 각 역할로 로그인
2. UI에서 버튼 표시 여부 확인

**예상 결과:**
- ✅ Admin: 모든 버튼 표시
- ✅ HR: 삭제 버튼 숨김, 나머지 표시
- ✅ Viewer: 추가/수정/삭제 버튼 모두 숨김

#### 5. API 레벨 권한 확인

**절차:**
1. 각 역할로 로그인
2. 브라우저 개발자 도구에서 API 호출 확인
3. 권한이 없는 작업 시도 (예: Viewer가 직원 추가 시도)

**예상 결과:**
- ✅ 권한이 없는 API 호출이 실패
- ✅ 적절한 오류 메시지 반환 (403 Forbidden)
- ✅ RLS 정책이 서버에서도 적용됨

---

## 유효성 검증 테스트

### 테스트 항목: 중복 데이터 제출 시 에러 처리 확인

#### 1. 사원번호 중복 체크 테스트

**절차:**
1. 직원 추가 폼 열기
2. 이미 존재하는 사원번호 입력
3. 폼 제출 시도

**예상 결과:**
- ✅ 실시간으로 중복 체크 수행 (onBlur 또는 onChange)
- ✅ 중복 오류 메시지 표시
- ✅ 폼 제출이 차단됨
- ✅ API 호출 전에 클라이언트에서 검증

#### 2. 이메일 중복 체크 테스트

**절차:**
1. 직원 추가 폼 열기
2. 이미 존재하는 이메일 입력
3. 폼 제출 시도

**예상 결과:**
- ✅ 실시간으로 중복 체크 수행
- ✅ 중복 오류 메시지 표시
- ✅ 폼 제출이 차단됨

#### 3. 서버 사이드 검증 테스트

**절차:**
1. 브라우저 개발자 도구에서 클라이언트 검증 우회
2. 중복 데이터를 포함한 요청 직접 전송

**예상 결과:**
- ✅ 서버에서도 검증 수행
- ✅ 중복 데이터가 저장되지 않음
- ✅ 적절한 오류 응답 반환

#### 4. 동시 중복 제출 테스트

**절차:**
1. 두 개의 브라우저 탭에서 동시에 같은 사원번호로 직원 추가 시도
2. 결과 확인

**예상 결과:**
- ✅ 첫 번째 요청만 성공
- ✅ 두 번째 요청은 중복 오류 반환
- ✅ 데이터 무결성 유지

---

## ✅ 테스트 체크리스트

### 보안
- [ ] 비인증 상태에서 페이지 접근 불가 확인
- [ ] RLS 정책 테스트
- [ ] Storage 접근 테스트

### 인증 시스템
- [ ] 로그인 테스트
- [ ] 잘못된 자격증명 테스트
- [ ] 로그아웃 테스트
- [ ] 세션 유지 테스트
- [ ] 세션 만료 테스트

### 역할 기반 접근 제어
- [ ] Admin 역할 테스트
- [ ] HR 역할 테스트
- [ ] Viewer 역할 테스트
- [ ] 권한별 UI 확인
- [ ] API 레벨 권한 확인

### 유효성 검증
- [ ] 사원번호 중복 체크 테스트
- [ ] 이메일 중복 체크 테스트
- [ ] 서버 사이드 검증 테스트
- [ ] 동시 중복 제출 테스트

---

## 📝 테스트 결과 기록

**테스트 날짜:** _______________

**테스터:** _______________

**전체 테스트 결과:**
- [ ] 모든 테스트 통과
- [ ] 일부 테스트 실패 (이슈 섹션에 기록)

**비고:**
_________________________________________________
_________________________________________________

---

**마지막 업데이트:** 2024년



