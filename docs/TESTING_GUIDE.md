# 테스트 가이드

이 문서는 인사관리 시스템의 주요 기능을 테스트하는 방법을 안내합니다.

## 목차

1. [인증 시스템 테스트](#인증-시스템-테스트)
2. [역할 기반 접근 제어 (RBAC) 테스트](#역할-기반-접근-제어-rbac-테스트)
3. [에러 바운더리 테스트](#에러-바운더리-테스트)
4. [서버 사이드 검증 API 테스트](#서버-사이드-검증-api-테스트)
5. [RLS 정책 테스트](#rls-정책-테스트)
6. [반응형 레이아웃 테스트](#반응형-레이아웃-테스트)

---

## 인증 시스템 테스트

### 테스트 페이지
- 로그인: `/login`
- 회원가입: `/signup`

### 테스트 항목

#### 1. 로그인 플로우
1. 로그인하지 않은 상태에서 메인 페이지(`/`) 접근
2. 자동으로 `/login` 페이지로 리다이렉트되는지 확인
3. 올바른 이메일과 비밀번호로 로그인
4. 로그인 성공 후 메인 페이지로 이동하는지 확인
5. 로그아웃 버튼 클릭
6. 로그아웃 후 다시 `/login` 페이지로 리다이렉트되는지 확인

#### 2. 회원가입 플로우
1. `/signup` 페이지 접근
2. 새 이메일과 비밀번호 입력
3. 회원가입 버튼 클릭
4. 회원가입 성공 시 로그인 페이지로 이동하는지 확인
5. 새로 생성된 계정으로 로그인 시도

#### 3. 에러 처리
- 잘못된 이메일 형식 입력 시 에러 메시지 표시 확인
- 잘못된 비밀번호 입력 시 에러 메시지 표시 확인
- 이미 존재하는 이메일로 회원가입 시도 시 에러 메시지 표시 확인

---

## 역할 기반 접근 제어 (RBAC) 테스트

### 사전 준비
1. Supabase 대시보드에서 `user_roles` 테이블에 사용자 역할 추가
2. 각 역할(admin, hr, viewer)에 해당하는 계정 준비

### 테스트 항목

#### 1. Admin 역할 테스트
1. Admin 계정으로 로그인
2. 메인 페이지에서 "새 직원 등록" 버튼이 보이는지 확인
3. 직원 카드에서 "수정" 버튼이 보이는지 확인
4. 직원 카드에서 "삭제" 버튼이 보이는지 확인
5. 직원 삭제 기능이 작동하는지 확인

#### 2. HR 역할 테스트
1. HR 계정으로 로그인
2. 메인 페이지에서 "새 직원 등록" 버튼이 보이는지 확인
3. 직원 카드에서 "수정" 버튼이 보이는지 확인
4. 직원 카드에서 "삭제" 버튼이 **보이지 않는지** 확인
5. 직원 수정 기능이 작동하는지 확인

#### 3. Viewer 역할 테스트
1. Viewer 계정으로 로그인
2. 메인 페이지에서 "새 직원 등록" 버튼이 **보이지 않는지** 확인
3. 직원 카드에서 "수정" 버튼이 **보이지 않는지** 확인
4. 직원 카드에서 "삭제" 버튼이 **보이지 않는지** 확인
5. 직원 정보 조회만 가능한지 확인

---

## 에러 바운더리 테스트

### 테스트 페이지
- `/test/error-boundary`

### 테스트 항목

#### 1. 동기 에러 테스트
1. `/test/error-boundary` 페이지 접근
2. "에러 발생시키기" 버튼 클릭
3. ErrorBoundary가 에러를 잡아서 사용자 친화적인 메시지를 표시하는지 확인
4. "다시 시도" 버튼 클릭하여 에러 상태 초기화 확인
5. "페이지 새로고침" 버튼 클릭하여 페이지가 정상적으로 새로고침되는지 확인

#### 2. 비동기 에러 테스트
1. "비동기 에러 발생시키기" 버튼 클릭
2. Toast 알림으로 에러 메시지가 표시되는지 확인
3. ErrorBoundary가 비동기 에러를 잡지 못함을 확인 (페이지가 깨지지 않음)

---

## 서버 사이드 검증 API 테스트

### 테스트 페이지
- `/test/api-validation`

### 테스트 항목

#### 1. 사원번호 중복 확인
1. `/test/api-validation` 페이지 접근
2. 이미 존재하는 사원번호 입력
3. "확인" 버튼 클릭
4. "이미 사용 중입니다" 메시지가 표시되는지 확인
5. 존재하지 않는 사원번호 입력
6. "확인" 버튼 클릭
7. "사용 가능합니다" 메시지가 표시되는지 확인

#### 2. 이메일 중복 확인
1. 이미 존재하는 이메일 입력
2. "확인" 버튼 클릭
3. "이미 사용 중입니다" 메시지가 표시되는지 확인
4. 존재하지 않는 이메일 입력
5. "확인" 버튼 클릭
6. "사용 가능합니다" 메시지가 표시되는지 확인

#### 3. 에러 처리
1. 빈 값으로 확인 시도
2. 에러 메시지가 표시되는지 확인
3. 잘못된 이메일 형식 입력 시 에러 메시지 표시 확인

---

## RLS 정책 테스트

### 사전 준비
1. Supabase SQL Editor에서 `docs/sql/rls_policies.sql` 스크립트 실행
2. RLS 정책이 활성화되었는지 확인

### 테스트 항목

#### 1. 비인증 사용자 접근 테스트
1. 로그아웃 상태에서 브라우저 개발자 도구 열기
2. Console 탭에서 다음 코드 실행:
   ```javascript
   // Supabase 클라이언트를 직접 사용하여 데이터 접근 시도
   // 이는 실제로는 ProtectedRoute에 의해 차단되지만,
   // RLS 정책이 제대로 설정되었는지 확인하기 위한 테스트
   ```
3. Supabase 대시보드의 Logs에서 RLS 정책에 의해 차단된 요청 확인

#### 2. 인증된 사용자 접근 테스트
1. 로그인 상태에서 메인 페이지 접근
2. 직원 목록이 정상적으로 표시되는지 확인
3. 직원 정보 수정/삭제 기능이 정상 작동하는지 확인

#### 3. 역할별 권한 테스트
1. Viewer 역할로 로그인
2. 직원 정보 조회는 가능하지만 수정/삭제는 불가능한지 확인
3. HR 역할로 로그인
4. 직원 정보 조회/수정은 가능하지만 삭제는 불가능한지 확인
5. Admin 역할로 로그인
6. 모든 기능(조회/수정/삭제)이 가능한지 확인

---

## 반응형 레이아웃 테스트

### 테스트 항목

#### 1. 모바일 뷰 (375px ~ 767px)
1. 브라우저 개발자 도구에서 모바일 뷰 활성화
2. 메인 페이지 접근
3. 직원 카드가 1열로 표시되는지 확인
4. 검색 바와 필터가 모바일에 맞게 표시되는지 확인
5. 버튼들이 터치하기 쉬운 크기인지 확인

#### 2. 태블릿 뷰 (768px ~ 1023px)
1. 태블릿 뷰 활성화
2. 직원 카드가 2열로 표시되는지 확인
3. 레이아웃이 태블릿에 맞게 최적화되었는지 확인

#### 3. 데스크톱 뷰 (1024px 이상)
1. 데스크톱 뷰 활성화
2. 직원 카드가 3열로 표시되는지 확인
3. 모든 기능이 정상적으로 작동하는지 확인

---

## 테스트 체크리스트

### Phase 1 테스트 항목
- [ ] 로그인/로그아웃 플로우 확인
- [ ] 각 역할(admin, hr, viewer)로 로그인하여 권한 확인
- [ ] 비인증 사용자가 데이터 접근 불가 확인
- [ ] 의도적 에러 발생 시 에러 바운더리 동작 확인
- [ ] 중복 데이터 제출 시 에러 처리 확인
- [ ] 반응형 레이아웃 확인 (모바일/태블릿/데스크톱)

---

## 문제 해결

### 테스트 중 발생할 수 있는 문제

1. **RLS 정책이 적용되지 않음**
   - Supabase 대시보드에서 RLS가 활성화되었는지 확인
   - SQL 스크립트가 정상적으로 실행되었는지 확인

2. **역할이 적용되지 않음**
   - `user_roles` 테이블에 사용자 역할이 올바르게 저장되었는지 확인
   - 사용자 ID가 올바른지 확인

3. **에러 바운더리가 작동하지 않음**
   - ErrorBoundary가 올바르게 컴포넌트를 감싸고 있는지 확인
   - 에러가 동기 에러인지 확인 (비동기 에러는 ErrorBoundary가 잡지 못함)

---

## 참고사항

- 모든 테스트는 개발 환경에서 수행하세요
- 프로덕션 환경에서는 테스트 페이지를 제거하거나 접근을 제한하세요
- 테스트 중 발생한 문제는 이슈 트래커에 기록하세요

